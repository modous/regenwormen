<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/backend/src/main/java/nl/hva/ewa/regenwormen/controller/ErrorReportController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/backend/src/main/java/nl/hva/ewa/regenwormen/controller/ErrorReportController.java" />
              <option name="originalContent" value="package nl.hva.ewa.regenwormen.controller;&#10;&#10;import nl.hva.ewa.regenwormen.domain.errorForm.ErrorReport;&#10;import nl.hva.ewa.regenwormen.domain.dto.ErrorReportDTO;&#10;import nl.hva.ewa.regenwormen.domain.Enum.ErrorStatus;&#10;import nl.hva.ewa.regenwormen.service.ErrorReportService;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.*;&#10;import org.springframework.web.multipart.MultipartFile;&#10;import com.fasterxml.jackson.databind.ObjectMapper;&#10;&#10;import java.io.IOException;&#10;import java.util.List;&#10;import java.util.Optional;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/api/error-reports&quot;)&#10;@CrossOrigin(origins = &quot;*&quot;)&#10;public class ErrorReportController {&#10;&#10;    private final ErrorReportService errorReportService;&#10;    private final ObjectMapper objectMapper;&#10;&#10;    @Autowired&#10;    public ErrorReportController(ErrorReportService errorReportService) {&#10;        this.errorReportService = errorReportService;&#10;        this.objectMapper = new ObjectMapper();&#10;    }&#10;&#10;    /**&#10;     * Nieuw error report aanmaken met game state JSON&#10;     * POST /api/error-reports&#10;     *&#10;     * Body: multipart/form-data&#10;     * - errorReport: JSON string met ErrorReportDTO (zonder gameStateJson)&#10;     * - snapshot: file (optional)&#10;     *&#10;     * Backend haalt Game object op via gameId en serialiseert het naar JSON&#10;     */&#10;    @PostMapping&#10;    public ResponseEntity&lt;ErrorReport&gt; createErrorReport(&#10;            @RequestPart(&quot;errorReport&quot;) String errorReportJson,&#10;            @RequestPart(value = &quot;snapshot&quot;, required = false) MultipartFile snapshotFile) {&#10;        try {&#10;            // Parse JSON string naar ErrorReportDTO&#10;            ErrorReportDTO errorReportDTO = objectMapper.readValue(errorReportJson, ErrorReportDTO.class);&#10;&#10;            // Backend haalt Game object op en serialiseert het&#10;            ErrorReport errorReport = errorReportService.createErrorReport(&#10;                    errorReportDTO.getName(),&#10;                    errorReportDTO.getTopic(),&#10;                    errorReportDTO.getCategory(),&#10;                    errorReportDTO.getPriority(),&#10;                    errorReportDTO.getDetails(),&#10;                    errorReportDTO.getUserId(),&#10;                    errorReportDTO.getGameId(),&#10;                    snapshotFile&#10;            );&#10;&#10;            return ResponseEntity.status(HttpStatus.CREATED).body(errorReport);&#10;        } catch (IOException e) {&#10;            return ResponseEntity.status(HttpStatus.BAD_REQUEST).build();&#10;        } catch (Exception e) {&#10;            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).build();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Alle error reports ophalen&#10;     * GET /api/error-reports&#10;     */&#10;    @GetMapping&#10;    public ResponseEntity&lt;List&lt;ErrorReport&gt;&gt; getAllErrorReports() {&#10;        List&lt;ErrorReport&gt; reports = errorReportService.getAllErrorReports();&#10;        return ResponseEntity.ok(reports);&#10;    }&#10;&#10;    /**&#10;     * Error report op ID ophalen&#10;     * GET /api/error-reports/{id}&#10;     */&#10;    @GetMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;ErrorReport&gt; getErrorReportById(@PathVariable String id) {&#10;        Optional&lt;ErrorReport&gt; errorReport = errorReportService.getErrorReportById(id);&#10;        return errorReport.map(ResponseEntity::ok)&#10;                .orElseGet(() -&gt; ResponseEntity.status(HttpStatus.NOT_FOUND).build());&#10;    }&#10;&#10;    /**&#10;     * Error reports van een gebruiker ophalen&#10;     * GET /api/error-reports/user/{userId}&#10;     */&#10;    @GetMapping(&quot;/user/{userId}&quot;)&#10;    public ResponseEntity&lt;List&lt;ErrorReport&gt;&gt; getErrorReportsByUserId(@PathVariable String userId) {&#10;        List&lt;ErrorReport&gt; reports = errorReportService.getErrorReportsByUserId(userId);&#10;        return ResponseEntity.ok(reports);&#10;    }&#10;&#10;    /**&#10;     * Error reports van een game ophalen&#10;     * GET /api/error-reports/game/{gameId}&#10;     */&#10;    @GetMapping(&quot;/game/{gameId}&quot;)&#10;    public ResponseEntity&lt;List&lt;ErrorReport&gt;&gt; getErrorReportsByGameId(@PathVariable String gameId) {&#10;        List&lt;ErrorReport&gt; reports = errorReportService.getErrorReportsByGameId(gameId);&#10;        return ResponseEntity.ok(reports);&#10;    }&#10;&#10;    /**&#10;     * Error reports filteren op status&#10;     * GET /api/error-reports/status/{status}&#10;     */&#10;    @GetMapping(&quot;/status/{status}&quot;)&#10;    public ResponseEntity&lt;List&lt;ErrorReport&gt;&gt; getErrorReportsByStatus(@PathVariable String status) {&#10;        try {&#10;            ErrorStatus errorStatus = ErrorStatus.valueOf(status.toUpperCase());&#10;            List&lt;ErrorReport&gt; reports = errorReportService.getErrorReportsByStatus(errorStatus);&#10;            return ResponseEntity.ok(reports);&#10;        } catch (IllegalArgumentException e) {&#10;            return ResponseEntity.status(HttpStatus.BAD_REQUEST).build();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Error reports filteren op game en status&#10;     * GET /api/error-reports/game/{gameId}/status/{status}&#10;     */&#10;    @GetMapping(&quot;/game/{gameId}/status/{status}&quot;)&#10;    public ResponseEntity&lt;List&lt;ErrorReport&gt;&gt; getErrorReportsByGameAndStatus(&#10;            @PathVariable String gameId,&#10;            @PathVariable String status) {&#10;        try {&#10;            ErrorStatus errorStatus = ErrorStatus.valueOf(status.toUpperCase());&#10;            List&lt;ErrorReport&gt; reports = errorReportService.getErrorReportsByGameAndStatus(gameId, errorStatus);&#10;            return ResponseEntity.ok(reports);&#10;        } catch (IllegalArgumentException e) {&#10;            return ResponseEntity.status(HttpStatus.BAD_REQUEST).build();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Status van een error report bijwerken&#10;     * PATCH /api/error-reports/{id}/status&#10;     */&#10;    @PatchMapping(&quot;/{id}/status&quot;)&#10;    public ResponseEntity&lt;ErrorReport&gt; updateErrorReportStatus(&#10;            @PathVariable String id,&#10;            @RequestParam String status) {&#10;        try {&#10;            ErrorStatus errorStatus = ErrorStatus.valueOf(status.toUpperCase());&#10;            ErrorReport updatedReport = errorReportService.updateErrorReportStatus(id, errorStatus);&#10;            return ResponseEntity.ok(updatedReport);&#10;        } catch (IllegalArgumentException e) {&#10;            return ResponseEntity.status(HttpStatus.BAD_REQUEST).build();&#10;        } catch (RuntimeException e) {&#10;            return ResponseEntity.status(HttpStatus.NOT_FOUND).build();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Error report bijwerken&#10;     * PUT /api/error-reports/{id}&#10;     */&#10;    @PutMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;ErrorReport&gt; updateErrorReport(&#10;            @PathVariable String id,&#10;            @RequestBody ErrorReportDTO errorReportDTO) {&#10;        try {&#10;            ErrorReport updatedReport = errorReportService.updateErrorReport(&#10;                    id,&#10;                    errorReportDTO.getName(),&#10;                    errorReportDTO.getTopic(),&#10;                    errorReportDTO.getCategory(),&#10;                    errorReportDTO.getPriority(),&#10;                    errorReportDTO.getDetails(),&#10;                    errorReportDTO.getStatus()&#10;            );&#10;            return ResponseEntity.ok(updatedReport);&#10;        } catch (RuntimeException e) {&#10;            return ResponseEntity.status(HttpStatus.NOT_FOUND).build();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Error report verwijderen&#10;     * DELETE /api/error-reports/{id}&#10;     */&#10;    @DeleteMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;Void&gt; deleteErrorReport(@PathVariable String id) {&#10;        try {&#10;            errorReportService.deleteErrorReport(id);&#10;            return ResponseEntity.noContent().build();&#10;        } catch (RuntimeException e) {&#10;            return ResponseEntity.status(HttpStatus.NOT_FOUND).build();&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package nl.hva.ewa.regenwormen.controller;&#10;&#10;import nl.hva.ewa.regenwormen.domain.errorForm.ErrorReport;&#10;import nl.hva.ewa.regenwormen.domain.dto.ErrorReportDTO;&#10;import nl.hva.ewa.regenwormen.domain.Enum.ErrorStatus;&#10;import nl.hva.ewa.regenwormen.service.ErrorReportService;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.*;&#10;import org.springframework.web.multipart.MultipartFile;&#10;import com.fasterxml.jackson.databind.ObjectMapper;&#10;&#10;import java.io.IOException;&#10;import java.util.List;&#10;import java.util.Optional;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/api/error-reports&quot;)&#10;@CrossOrigin(origins = &quot;*&quot;)&#10;public class ErrorReportController {&#10;&#10;    private final ErrorReportService errorReportService;&#10;    private final ObjectMapper objectMapper;&#10;&#10;    @Autowired&#10;    public ErrorReportController(ErrorReportService errorReportService) {&#10;        this.errorReportService = errorReportService;&#10;        this.objectMapper = new ObjectMapper();&#10;    }&#10;&#10;    /**&#10;     * Nieuw error report aanmaken met game state JSON&#10;     * POST /api/error-reports&#10;     *&#10;     * Body: multipart/form-data&#10;     * - errorReport: JSON string met ErrorReportDTO (zonder gameStateJson)&#10;     * - snapshot: file (optional)&#10;     *&#10;     * Backend haalt Game object op via gameId en serialiseert het naar JSON&#10;     */&#10;    @PostMapping&#10;    public ResponseEntity&lt;ErrorReport&gt; createErrorReport(&#10;            @RequestPart(&quot;errorReport&quot;) String errorReportJson,&#10;            @RequestPart(value = &quot;snapshot&quot;, required = false) MultipartFile snapshotFile) {&#10;        try {&#10;            // Parse JSON string naar ErrorReportDTO&#10;            ErrorReportDTO errorReportDTO = objectMapper.readValue(errorReportJson, ErrorReportDTO.class);&#10;&#10;            // Backend haalt Game object op en serialiseert het&#10;            ErrorReport errorReport = errorReportService.createErrorReport(&#10;                    errorReportDTO.getName(),&#10;                    errorReportDTO.getTopic(),&#10;                    errorReportDTO.getCategory(),&#10;                    errorReportDTO.getPriority(),&#10;                    errorReportDTO.getDetails(),&#10;                    errorReportDTO.getUserId(),&#10;                    errorReportDTO.getGameId(),&#10;                    snapshotFile&#10;            );&#10;&#10;            return ResponseEntity.status(HttpStatus.CREATED).body(errorReport);&#10;        } catch (IOException e) {&#10;            return ResponseEntity.status(HttpStatus.BAD_REQUEST).build();&#10;        } catch (Exception e) {&#10;            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).build();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Alle error reports ophalen&#10;     * GET /api/error-reports&#10;     */&#10;    @GetMapping&#10;    public ResponseEntity&lt;List&lt;ErrorReport&gt;&gt; getAllErrorReports() {&#10;        List&lt;ErrorReport&gt; reports = errorReportService.getAllErrorReports();&#10;        return ResponseEntity.ok(reports);&#10;    }&#10;&#10;    /**&#10;     * Error report op ID ophalen&#10;     * GET /api/error-reports/{id}&#10;     */&#10;    @GetMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;ErrorReport&gt; getErrorReportById(@PathVariable String id) {&#10;        Optional&lt;ErrorReport&gt; errorReport = errorReportService.getErrorReportById(id);&#10;        return errorReport.map(ResponseEntity::ok)&#10;                .orElseGet(() -&gt; ResponseEntity.status(HttpStatus.NOT_FOUND).build());&#10;    }&#10;&#10;    /**&#10;     * Error reports van een gebruiker ophalen&#10;     * GET /api/error-reports/user/{userId}&#10;     */&#10;    @GetMapping(&quot;/user/{userId}&quot;)&#10;    public ResponseEntity&lt;List&lt;ErrorReport&gt;&gt; getErrorReportsByUserId(@PathVariable String userId) {&#10;        List&lt;ErrorReport&gt; reports = errorReportService.getErrorReportsByUserId(userId);&#10;        return ResponseEntity.ok(reports);&#10;    }&#10;&#10;    /**&#10;     * Error reports van een game ophalen&#10;     * GET /api/error-reports/game/{gameId}&#10;     */&#10;    @GetMapping(&quot;/game/{gameId}&quot;)&#10;    public ResponseEntity&lt;List&lt;ErrorReport&gt;&gt; getErrorReportsByGameId(@PathVariable String gameId) {&#10;        List&lt;ErrorReport&gt; reports = errorReportService.getErrorReportsByGameId(gameId);&#10;        return ResponseEntity.ok(reports);&#10;    }&#10;&#10;    /**&#10;     * Error reports filteren op status&#10;     * GET /api/error-reports/status/{status}&#10;     */&#10;    @GetMapping(&quot;/status/{status}&quot;)&#10;    public ResponseEntity&lt;List&lt;ErrorReport&gt;&gt; getErrorReportsByStatus(@PathVariable String status) {&#10;        try {&#10;            ErrorStatus errorStatus = ErrorStatus.valueOf(status.toUpperCase());&#10;            List&lt;ErrorReport&gt; reports = errorReportService.getErrorReportsByStatus(errorStatus);&#10;            return ResponseEntity.ok(reports);&#10;        } catch (IllegalArgumentException e) {&#10;            return ResponseEntity.status(HttpStatus.BAD_REQUEST).build();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Error reports filteren op game en status&#10;     * GET /api/error-reports/game/{gameId}/status/{status}&#10;     */&#10;    @GetMapping(&quot;/game/{gameId}/status/{status}&quot;)&#10;    public ResponseEntity&lt;List&lt;ErrorReport&gt;&gt; getErrorReportsByGameAndStatus(&#10;            @PathVariable String gameId,&#10;            @PathVariable String status) {&#10;        try {&#10;            ErrorStatus errorStatus = ErrorStatus.valueOf(status.toUpperCase());&#10;            List&lt;ErrorReport&gt; reports = errorReportService.getErrorReportsByGameAndStatus(gameId, errorStatus);&#10;            return ResponseEntity.ok(reports);&#10;        } catch (IllegalArgumentException e) {&#10;            return ResponseEntity.status(HttpStatus.BAD_REQUEST).build();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Status van een error report bijwerken&#10;     * PATCH /api/error-reports/{id}/status&#10;     */&#10;    @PatchMapping(&quot;/{id}/status&quot;)&#10;    public ResponseEntity&lt;ErrorReport&gt; updateErrorReportStatus(&#10;            @PathVariable String id,&#10;            @RequestParam String status) {&#10;        try {&#10;            ErrorStatus errorStatus = ErrorStatus.valueOf(status.toUpperCase());&#10;            ErrorReport updatedReport = errorReportService.updateErrorReportStatus(id, errorStatus);&#10;            return ResponseEntity.ok(updatedReport);&#10;        } catch (IllegalArgumentException e) {&#10;            return ResponseEntity.status(HttpStatus.BAD_REQUEST).build();&#10;        } catch (RuntimeException e) {&#10;            return ResponseEntity.status(HttpStatus.NOT_FOUND).build();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Error report bijwerken&#10;     * PUT /api/error-reports/{id}&#10;     */&#10;    @PutMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;ErrorReport&gt; updateErrorReport(&#10;            @PathVariable String id,&#10;            @RequestBody ErrorReportDTO errorReportDTO) {&#10;        try {&#10;            ErrorReport updatedReport = errorReportService.updateErrorReport(&#10;                    id,&#10;                    errorReportDTO.getName(),&#10;                    errorReportDTO.getTopic(),&#10;                    errorReportDTO.getCategory(),&#10;                    errorReportDTO.getPriority(),&#10;                    errorReportDTO.getDetails(),&#10;                    errorReportDTO.getStatus()&#10;            );&#10;            return ResponseEntity.ok(updatedReport);&#10;        } catch (RuntimeException e) {&#10;            return ResponseEntity.status(HttpStatus.NOT_FOUND).build();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Error report verwijderen&#10;     * DELETE /api/error-reports/{id}&#10;     */&#10;    @DeleteMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;Void&gt; deleteErrorReport(@PathVariable String id) {&#10;        try {&#10;            errorReportService.deleteErrorReport(id);&#10;            return ResponseEntity.noContent().build();&#10;        } catch (RuntimeException e) {&#10;            return ResponseEntity.status(HttpStatus.NOT_FOUND).build();&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/backend/src/main/java/nl/hva/ewa/regenwormen/domain/errorForm/ErrorRecord.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/backend/src/main/java/nl/hva/ewa/regenwormen/domain/errorForm/ErrorRecord.java" />
              <option name="originalContent" value="package nl.hva.ewa.regenwormen.domain.errorForm;&#10;&#10;public class ErrorRecord {&#10;}&#10;" />
              <option name="updatedContent" value="package nl.hva.ewa.regenwormen.domain.errorForm;&#10;&#10;import nl.hva.ewa.regenwormen.domain.Enum.ErrorStatus;&#10;import nl.hva.ewa.regenwormen.domain.Enum.GameState;&#10;&#10;public record ErrorRecord(&#10;    String name,&#10;    String topic,&#10;    String category,&#10;    String priority,&#10;    String details,&#10;    GameState gameState,&#10;    String userId,&#10;    String gameId&#10;) {&#10;    // Record class voor eenvoudige error report data&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>